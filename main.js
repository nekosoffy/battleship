(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var r=n.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=function(){const e=Array.from({length:10},(()=>Array(10).fill(null))),t=[],n=[];let r=!0;const o=function(){r=!r},i=function(t,o){const i=o.getLength(),c=e[t[0]],s=t[1];if(null!==c[s])return!1;if(r){const e=s-Math.floor(i/2),t=e+i-1;if(e<0||t>=10)return!1;if(!c.slice(e,t+1).every((e=>null===e)))return!1;for(let n=e;n<=t;n++)c[n]=o;n.push(o)}if(!r){const r=t[0]-Math.floor(i/2),c=r+i-1;for(let n=r;n<=c;n++)if(void 0===e[n]||null!==e[n][t[1]])return!1;for(let n=r;n<=c;n++)e[n][t[1]]=o;n.push(o)}return!0};return{boardArray:function(){return e},grid:function(t,n){return e[t][n]},rotate:o,placeShip:i,placeShipRandom:function(e){Math.random()<.5&&o();let t=!1;for(;!t;){const n=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());t=i([n,r],e)}return t},receiveAttack:function(r,o){if(t.some((e=>e[0]===r&&e[1]===o)))return!1;const i=e[r][o];return"object"==typeof i&&null!==i?(i.hit(),e[r][o]="hit",t.push([r,o]),!0===i.isSunk()&&n.splice(n[n.indexOf(i)],1),"ship"):(null===i&&(e[r][o]="miss",t.push([r,o])),!0)},shipsSank:function(){return!n.length}}},n=function(e){if(e<2||e>5)return;const t=e;let n=0,r=!1;return{hit:function(){n+=1},isSunk:function(){return n>=t&&(r=!0),r},getLength:function(){return t}}},r=function(){const e=t(),r={two:n(2),threeOne:n(3),threeTwo:n(3),four:n(4),five:n(5)};return{...e,getShip:function(e){return r[e]},placeAllShips:function(){const t=Object.values(r);for(;t.length;)e.placeShipRandom(t.at(-1))&&t.pop()}}},o=function(){const e=r(),t=[];for(let e=0;e<10;e++)for(let n=0;n<10;n++)(e+n)%2==0&&t.push([e,n]);let n=!0;const o=[];let i=null;const c=[];return{...e,makePlay:function(){const e=e=>{const n=t.findIndex((t=>t[0]===e[0]&&t[1]===e[1]));-1!==n&&t.splice(n,1)};if(!n){const t=o.pop();return c.push(t),e(t),o.length||(n=!0),t}const r=t[Math.floor(Math.random()*t.length)];return c.push(r),e(r),r},setLastHitShot:function(e){i=e,function(){const e=[[i[0],i[1]-1],[i[0]-1,i[1]],[i[0],i[1]+1],[i[0]+1,i[1]]].filter((e=>e[0]>=0&&e[0]<10&&e[1]>=0&&e[1]<10&&!c.some((t=>t[0]===e[0]&&t[1]===e[1]))));o.push(...e)}(),n=!1}}},i=e.p+"7a3f665d60456c367f85.png",c=e.p+"977f08018db10ec0f291.svg",s=e.p+"9eff975d098150c0c2a8.svg",a=e.p+"0979aec3639a2a5e5b2e.svg";let l;const d=document.querySelector("main"),u=function(e,t,n="",r=null,o="",i="",c=""){const s=document.createElement(e);return n&&s.classList.add(n),r&&s.setAttribute(r,o),i&&(s.id=i),c&&(s.textContent=c),t.appendChild(s),s},h=function(e,t="open"){d.replaceChildren();const n=document.createElement("section");e.flat().forEach((e=>{const r=document.createElement("div");"open"===t&&((e,t)=>{"miss"===e&&u("img",t,"","src",a,"",""),"object"==typeof e&&null!==e&&u("img",t,"","src",c,"",""),"hit"===e&&(u("img",t,"","src",c,"",""),t.classList.add("hit"))})(e,r),"hidden"===t&&(((e,t)=>{"miss"===e&&(u("img",t,"","src",s,"",""),t.classList.add("miss")),"hit"===e&&(u("img",t,"","src",i,"",""),t.classList.add("hit"))})(e,r),r.addEventListener("mouseenter",(()=>{r.classList.add("hover")})),r.addEventListener("mouseleave",(()=>{r.classList.remove("hover")}))),n.appendChild(r)})),d.prepend(n)},f=function(e){let t=e.parentNode.querySelectorAll("div");t=[...t];const n=t.indexOf(e);return[Math.floor(n/10),n%10]},p=function(){const e=document.querySelector("aside");[{num:2,size:"two"},{num:3,size:"threeOne"},{num:3,size:"threeTwo"},{num:4,size:"four"},{num:5,size:"five"}].forEach((({num:t,size:n})=>function(t,n){const r=u("div",e,"ship","draggable","true",n);for(let e=0;e<t;e++)u("img",r,"","src",c,"","").draggable=!1;return r}(t,n)));e.querySelectorAll("div").forEach((e=>{e.addEventListener("dragstart",(e=>{e.dataTransfer.setData("text",e.target.id),l=e.target.children.length}))}))},m=function(e){const t=document.querySelector("aside"),n=document.querySelector(".combat-btn");return"off"===e?(t.replaceChildren(),t.classList.add("hidden"),void(n.disabled=!1)):"on"===e?(t.replaceChildren(),p(),t.classList.remove("hidden"),void(n.disabled=!0)):0===t.childNodes.length?(t.classList.toggle("hidden"),void(n.disabled=!1)):void(t.classList.contains("hidden")&&(p(),t.classList.toggle("hidden"),n.disabled=!0))},g=function(e,t){const n=document.querySelector(".btn-wrapper");return u("button",n,e,null,"","",t)},v=function(){document.querySelector("section").querySelectorAll(".highlight").forEach((e=>{e.classList.remove("highlight"),e.classList.remove("invalid")}))},y=function(e){const t=document.querySelector("section"),n=t.querySelectorAll("div");t.addEventListener("drop",(t=>{t.preventDefault();const{target:n}=t,r=t.dataTransfer.getData("text"),o=document.getElementById(r);if(!n.classList.contains("occupied")&&!n.src){const t=f(n);e.placeShip(t,e.getShip(r))&&(h(e.boardArray()),o.remove(),y(e))}m(),v()})),t.addEventListener("dragover",(e=>{e.preventDefault();const n=t.getBoundingClientRect();!function(e,t,n){const r=document.querySelector("section"),o=n.width/10,i=n.height/10,c=Math.floor(e/o),s=10*Math.floor(t/i)+c,a=Math.max(0,Math.min(s,99));r.querySelectorAll(".highlight").forEach((e=>{e.classList.remove("highlight")})),r.querySelectorAll(".invalid").forEach((e=>{e.classList.remove("invalid")}));const d=a-Math.floor(l/2);let u=!0;for(let e=0;e<l;e++){const t=d+e;if(t>=0&&t<r.children.length&&Math.floor(t/10)===Math.floor(a/10)){const e=r.children[t];e.classList.contains("occupied")&&(u=!1),e.classList.add("highlight")}else u=!1}if(!u)for(let e=0;e<l;e++){const t=d+e;t>=0&&t<r.children.length&&Math.floor(t/10)===Math.floor(a/10)&&r.children[t].classList.add("invalid")}}(e.clientX-n.left,e.clientY-n.top,n)})),t.addEventListener("dragleave",(e=>{e.preventDefault(),v()})),n.forEach((e=>{0!==e.childNodes.length&&e.classList.add("occupied")}))},b=function(e){const t=document.querySelector(".intro-wrapper");t.replaceChildren(),u("h2",t,"information",null,"","",e)},S=function(){document.querySelector("section").classList.add("field")};let L=r(),A=o(),w=!1;const q=document.getElementById("play-cpu-btn"),E=document.querySelector("h1"),M=document.querySelector(".container"),k=function(){w=!1,L=r(),A=o()};function C(e){return new Promise((t=>{setTimeout(t,e)}))}const T=function(){const e=async()=>{await C(1500);const e=document.querySelector(".btn-wrapper");e.replaceChildren(),e.classList.remove("invisible"),g("replay-btn","Rematch!")};L.shipsSank()?(w=!0,b("You were annihilated..."),e()):A.shipsSank()&&(w=!0,b("Humans have won!"),e())},x=function(e){b("Your move!"),h(A.boardArray(),"hidden"),S();document.querySelector("section").addEventListener("click",(t=>{if(!1===w){const{target:n}=t;e(n)}}))},z=function(e){let t=!1;if(0===e.childNodes.length&&!e.src){const n=f(e);t=A.receiveAttack(n[0],n[1])}if(t){"ship"===t&&b("Your shot hit an alien!"),h(A.boardArray(),"hidden"),S(),T();w||(async()=>{await C(2e3),h(L.boardArray()),b("The aliens are attacking..."),await C(2e3);const e=A.makePlay(),t=L.receiveAttack(e[0],e[1]);h(L.boardArray()),"ship"===t&&(A.setLastHitShot(e),b("An unit was striked!")),T(),w||(await C(2e3),x(z))})()}},P=function(){document.querySelector(".btn-wrapper").replaceChildren(),k(),A.placeAllShips(),b("Position your fleet!"),h(L.boardArray()),g("reset-btn","Reset Placement");const e=g("combat-btn","Begin Combat");g("random-btn","Randomize"),m(),p(),y(L),e.disabled=!0};M.addEventListener("click",(e=>{const{target:t}=e;"play-cpu-btn"===t.id&&(E.remove(),q.remove(),P()),t.classList.contains("reset-btn")&&(k(),h(L.boardArray()),y(L),m("on")),t.classList.contains("combat-btn")&&(document.querySelector(".btn-wrapper").classList.add("invisible"),m("off"),x(z)),t.classList.contains("random-btn")&&(k(),L.placeAllShips(),A.placeAllShips(),h(L.boardArray()),m("off")),t.classList.contains("replay-btn")&&P()}))})();
//# sourceMappingURL=main.js.map